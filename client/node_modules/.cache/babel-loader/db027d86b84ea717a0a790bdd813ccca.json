{"ast":null,"code":"import _classCallCheck from\"/my projects/pocketPhotoEditor/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/my projects/pocketPhotoEditor/client/node_modules/@babel/runtime/helpers/esm/createClass\";/* eslint no-restricted-globals: 0 */import auth0 from\"auth0-js\";import jwtDecode from\"jwt-decode\";var LOGIN_SUCCESS_PAGE=\"/myfeed\";var LOGIN_FAILURE_PAGE=\"/\";var Auth=/*#__PURE__*/function(){function Auth(){_classCallCheck(this,Auth);this.auth0=new auth0.WebAuth({domain:\"dev-qm0-ivzk.auth0.com\",clientID:\"QNCYbMnNO5ezHlm7WMc694bM6MOenTgO\",redirectUri:window.location.origin+\"/callback\",audience:\"https://dev-qm0-ivzk.auth0.com/userinfo\",responseType:\"token id_token\",scope:\"openid profile\"});this.login=this.login.bind(this);}_createClass(Auth,[{key:\"login\",value:function login(){console.log('login method in auth.js');this.auth0.authorize();}},{key:\"handleAuthentication\",value:function handleAuthentication(){console.log('parse hash');this.auth0.parseHash(function(err,authResults){console.log(authResults);if(authResults&&authResults.accessToken&&authResults.idToken){var expiresAt=JSON.stringify(authResults.expiresIn*1000+new Date().getTime());localStorage.setItem(\"access_token\",authResults.accessToken);localStorage.setItem(\"id_token\",authResults.idToken);localStorage.setItem(\"expires_at\",expiresAt);window.location.hash=\"\";window.location.pathname=LOGIN_SUCCESS_PAGE;}else if(err){window.location.pathname=LOGIN_FAILURE_PAGE;console.log(err);}});}},{key:\"isAuthenticated\",value:function isAuthenticated(){var expiresAt=JSON.parse(localStorage.getItem(\"expires_at\"));console.log(expiresAt);return new Date().getTime()<expiresAt;}},{key:\"logout\",value:function logout(){localStorage.removeItem(\"access_token\");localStorage.removeItem(\"id_token\");localStorage.removeItem(\"expires_at\");window.location.pathname=LOGIN_FAILURE_PAGE;}},{key:\"getProfile\",value:function getProfile(){if(localStorage.getItem(\"id_token\")){console.log(jwtDecode(localStorage.getItem(\"id_token\")));return jwtDecode(localStorage.getItem(\"id_token\"));}else{return{};}}}]);return Auth;}();export{Auth as default};","map":{"version":3,"sources":["/my projects/pocketPhotoEditor/client/src/Auth.js"],"names":["auth0","jwtDecode","LOGIN_SUCCESS_PAGE","LOGIN_FAILURE_PAGE","Auth","WebAuth","domain","clientID","redirectUri","window","location","origin","audience","responseType","scope","login","bind","console","log","authorize","parseHash","err","authResults","accessToken","idToken","expiresAt","JSON","stringify","expiresIn","Date","getTime","localStorage","setItem","hash","pathname","parse","getItem","removeItem"],"mappings":"8OAAA,qCACA,MAAOA,CAAAA,KAAP,KAAkB,UAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,YAAtB,CAEA,GAAMC,CAAAA,kBAAkB,CAAG,SAA3B,CACA,GAAMC,CAAAA,kBAAkB,CAAG,GAA3B,C,GAEqBC,CAAAA,I,yBAUjB,eAAc,iCATdJ,KASc,CATN,GAAIA,CAAAA,KAAK,CAACK,OAAV,CAAkB,CACtBC,MAAM,CAAE,wBADc,CAEtBC,QAAQ,CAAE,kCAFY,CAGtBC,WAAW,CAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAyB,WAHhB,CAItBC,QAAQ,CAAE,yCAJY,CAKtBC,YAAY,CAAE,gBALQ,CAMtBC,KAAK,CAAE,gBANe,CAAlB,CASM,CACV,KAAKC,KAAL,CAAa,KAAKA,KAAL,CAAWC,IAAX,CAAgB,IAAhB,CAAb,CACH,C,sDAEO,CACJC,OAAO,CAACC,GAAR,CAAY,yBAAZ,EACA,KAAKlB,KAAL,CAAWmB,SAAX,GACH,C,mEAEsB,CACnBF,OAAO,CAACC,GAAR,CAAY,YAAZ,EACA,KAAKlB,KAAL,CAAWoB,SAAX,CAAqB,SAACC,GAAD,CAAMC,WAAN,CAAsB,CACvCL,OAAO,CAACC,GAAR,CAAYI,WAAZ,EACA,GAAIA,WAAW,EAAIA,WAAW,CAACC,WAA3B,EAA0CD,WAAW,CAACE,OAA1D,CAAmE,CAC/D,GAAIC,CAAAA,SAAS,CAAGC,IAAI,CAACC,SAAL,CAAgBL,WAAW,CAACM,SAAb,CAA0B,IAA1B,CAAiC,GAAIC,CAAAA,IAAJ,GAAWC,OAAX,EAAhD,CAAhB,CACAC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAqCV,WAAW,CAACC,WAAjD,EACAQ,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCV,WAAW,CAACE,OAA7C,EACAO,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAmCP,SAAnC,EACAhB,MAAM,CAACC,QAAP,CAAgBuB,IAAhB,CAAuB,EAAvB,CACAxB,MAAM,CAACC,QAAP,CAAgBwB,QAAhB,CAA2BhC,kBAA3B,CAEH,CARD,IAQO,IAAImB,GAAJ,CAAS,CACZZ,MAAM,CAACC,QAAP,CAAgBwB,QAAhB,CAA2B/B,kBAA3B,CACAc,OAAO,CAACC,GAAR,CAAYG,GAAZ,EACH,CACJ,CAdD,EAeH,C,yDAEiB,CACd,GAAII,CAAAA,SAAS,CAAGC,IAAI,CAACS,KAAL,CAAWJ,YAAY,CAACK,OAAb,CAAqB,YAArB,CAAX,CAAhB,CACAnB,OAAO,CAACC,GAAR,CAAYO,SAAZ,EACA,MAAO,IAAII,CAAAA,IAAJ,GAAWC,OAAX,GAAuBL,SAA9B,CACH,C,uCAEQ,CACLM,YAAY,CAACM,UAAb,CAAwB,cAAxB,EACAN,YAAY,CAACM,UAAb,CAAwB,UAAxB,EACAN,YAAY,CAACM,UAAb,CAAwB,YAAxB,EACA5B,MAAM,CAACC,QAAP,CAAgBwB,QAAhB,CAA2B/B,kBAA3B,CACH,C,+CAEY,CACT,GAAG4B,YAAY,CAACK,OAAb,CAAqB,UAArB,CAAH,CAAqC,CACjCnB,OAAO,CAACC,GAAR,CAAYjB,SAAS,CAAC8B,YAAY,CAACK,OAAb,CAAqB,UAArB,CAAD,CAArB,EACA,MAAOnC,CAAAA,SAAS,CAAC8B,YAAY,CAACK,OAAb,CAAqB,UAArB,CAAD,CAAhB,CACH,CAHD,IAGO,CACH,MAAO,EAAP,CACH,CACJ,C,2BA1DgBhC,I","sourcesContent":["/* eslint no-restricted-globals: 0 */\nimport auth0 from \"auth0-js\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOGIN_SUCCESS_PAGE = \"/myfeed\";\nconst LOGIN_FAILURE_PAGE = \"/\";\n\nexport default class Auth {\n    auth0 = new auth0.WebAuth({\n        domain: \"dev-qm0-ivzk.auth0.com\",\n        clientID: \"QNCYbMnNO5ezHlm7WMc694bM6MOenTgO\",\n        redirectUri: window.location.origin + \"/callback\",\n        audience: \"https://dev-qm0-ivzk.auth0.com/userinfo\",\n        responseType: \"token id_token\",\n        scope: \"openid profile\" \n    });\n\n    constructor() {\n        this.login = this.login.bind(this);\n    }\n\n    login() {\n        console.log('login method in auth.js')\n        this.auth0.authorize();\n    }\n\n    handleAuthentication() {\n        console.log('parse hash')\n        this.auth0.parseHash((err, authResults) => {\n            console.log(authResults);\n            if (authResults && authResults.accessToken && authResults.idToken) {\n                let expiresAt = JSON.stringify((authResults.expiresIn) * 1000 + new Date().getTime());\n                localStorage.setItem(\"access_token\", authResults.accessToken);\n                localStorage.setItem(\"id_token\", authResults.idToken);\n                localStorage.setItem(\"expires_at\", expiresAt);\n                window.location.hash = \"\";\n                window.location.pathname = LOGIN_SUCCESS_PAGE;\n\n            } else if (err) {\n                window.location.pathname = LOGIN_FAILURE_PAGE;\n                console.log(err);\n            }\n        })\n    }\n\n    isAuthenticated() {\n        let expiresAt = JSON.parse(localStorage.getItem(\"expires_at\"));\n        console.log(expiresAt);\n        return new Date().getTime() < expiresAt;\n    }\n\n    logout() {\n        localStorage.removeItem(\"access_token\");\n        localStorage.removeItem(\"id_token\");\n        localStorage.removeItem(\"expires_at\");\n        window.location.pathname = LOGIN_FAILURE_PAGE;\n    }\n\n    getProfile() {\n        if(localStorage.getItem(\"id_token\")) {\n            console.log(jwtDecode(localStorage.getItem(\"id_token\")));\n            return jwtDecode(localStorage.getItem(\"id_token\"));\n        } else {\n            return {};\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}